---
sidebar: sidebar 
permalink: vmware/vmw-azure-avs-migrate-hcx.html 
keywords: azure, avs, hybrid multicloud, migrate, vmware hcx, hcx 
summary:  
---
= TR-4940: VMware HCX를 사용하여 워크로드를 Azure NetApp Files 데이터 저장소로 마이그레이션 - 빠른 시작 가이드
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Azure VMware Solution 및 Azure NetApp Files 데이터 저장소의 가장 일반적인 사용 사례 중 하나는 VMware 워크로드의 마이그레이션입니다.  VMware HCX는 선호되는 옵션으로, 온-프레미스 가상 머신(VM)과 해당 데이터를 Azure NetApp Files 데이터 저장소로 옮기는 다양한 마이그레이션 메커니즘을 제공합니다.



== 개요: VMware HCX, Azure NetApp Files 데이터 저장소 및 Azure VMware 솔루션을 사용하여 가상 머신 마이그레이션

VMware HCX는 기본적으로 애플리케이션 마이그레이션, 워크로드 리밸런싱, 심지어 클라우드 전반의 비즈니스 연속성을 단순화하도록 설계된 마이그레이션 플랫폼입니다.  Azure VMware Solution Private Cloud의 일부로 포함되어 있으며 워크로드를 마이그레이션하는 다양한 방법을 제공하며 재해 복구(DR) 작업에 사용할 수 있습니다.

이 문서에서는 Azure NetApp Files 데이터 저장소를 프로비저닝하고, 온프레미스와 Azure VMware 솔루션 측의 모든 주요 구성 요소를 포함하여 VMware HCX를 다운로드, 배포 및 구성하는 방법에 대한 단계별 지침을 제공합니다. 여기에는 다양한 VM 마이그레이션 메커니즘을 활성화하기 위한 상호 연결, 네트워크 확장 및 WAN 최적화가 포함됩니다.


NOTE: VMware HCX는 마이그레이션이 VM 수준에서 진행되므로 모든 데이터 저장소 유형과 호환됩니다.  따라서 이 문서는 기존 NetApp 고객과 비용 효율적인 VMware 클라우드 배포를 위해 Azure VMware Solution과 함께 Azure NetApp Files 배포할 계획인 비 NetApp 고객에게 적용됩니다.

.상위 수준 단계
[%collapsible%open]
====
이 목록은 Azure 클라우드 측에 HCX Cloud Manager를 설치 및 구성하고 온프레미스에 HCX Connector를 설치하는 데 필요한 개략적인 단계를 제공합니다.

. Azure Portal을 통해 HCX를 설치합니다.
. 온프레미스 VMware vCenter Server에 HCX Connector Open Virtualization Appliance(OVA) 설치 프로그램을 다운로드하여 배포합니다.
. 라이선스 키로 HCX를 활성화하세요.
. 온프레미스 VMware HCX Connector를 Azure VMware Solution HCX Cloud Manager와 연결합니다.
. 네트워크 프로필, 컴퓨팅 프로필 및 서비스 메시를 구성합니다.
. (선택 사항) 마이그레이션 중에 재IP를 방지하기 위해 네트워크 확장을 수행합니다.
. 기기 상태를 검증하고 마이그레이션이 가능한지 확인하세요.
. VM 워크로드를 마이그레이션합니다.


====
.필수 조건
[%collapsible%open]
====
시작하기 전에 다음 전제 조건이 충족되었는지 확인하세요.  자세한 내용은 다음을 참조하세요. https://docs.microsoft.com/en-us/azure/azure-vmware/configure-vmware-hcx["링크"^] .  연결성을 포함한 필수 구성 요소가 준비되면 Azure VMware Solution 포털에서 라이선스 키를 생성하여 HCX를 구성하고 활성화합니다.  OVA 설치 프로그램을 다운로드한 후 아래 설명된 대로 설치 과정을 진행하세요.


NOTE: HCX Advanced가 기본 옵션이며, VMware HCX Enterprise Edition도 지원 티켓을 통해 이용 가능하며 추가 비용 없이 지원됩니다.

* 기존 Azure VMware 솔루션 소프트웨어 정의 데이터 센터(SDDC)를 사용하거나 이를 사용하여 프라이빗 클라우드를 만듭니다.link:vmw-azure-avs-setup.html["NetApp 링크"^] 아니면 이것 https://docs.microsoft.com/en-us/azure/azure-vmware/deploy-azure-vmware-solution?tabs=azure-portal["마이크로소프트 링크"^] .
* 온프레미스 VMware vSphere 지원 데이터 센터에서 VM 및 관련 데이터를 마이그레이션하려면 데이터 센터에서 SDDC 환경으로의 네트워크 연결이 필요합니다.  워크로드를 마이그레이션하기 전에 https://docs.microsoft.com/en-us/azure/azure-vmware/tutorial-expressroute-global-reach-private-cloud["사이트 간 VPN 또는 Express Route Global Reach 연결을 설정하세요"^] 온프레미스 환경과 해당 프라이빗 클라우드 간.
* 온프레미스 VMware vCenter Server 환경에서 Azure VMware Solution 프라이빗 클라우드로의 네트워크 경로는 vMotion을 사용하여 VM 마이그레이션을 지원해야 합니다.
* 필수 사항을 확인하세요 https://learn.microsoft.com/en-us/azure/azure-vmware/tutorial-network-checklist?source=recommendations["방화벽 규칙 및 포트"^] 온프레미스 vCenter Server와 SDDC vCenter 간의 vMotion 트래픽이 허용됩니다.  프라이빗 클라우드에서는 vMotion 네트워크의 라우팅이 기본적으로 구성됩니다.
* Azure NetApp Files NFS 볼륨은 Azure VMware Solution의 데이터 저장소로 마운트되어야 합니다.  여기에 자세히 설명된 단계를 따르세요. https://learn.microsoft.com/en-us/azure/azure-vmware/attach-azure-netapp-files-to-azure-vmware-solution-hosts?tabs=azure-portal["링크"^] Azure NetApp Files 데이터 저장소를 Azure VMware Solutions 호스트에 연결합니다.


====
.고수준 아키텍처
[%collapsible%open]
====
테스트 목적으로, 이 검증에 사용된 온프레미스 랩 환경은 사이트 간 VPN을 통해 연결되었으며, 이를 통해 온프레미스에서 Azure VMware Solution으로 연결할 수 있습니다.

image:anfd-hcx-001.png["이 이미지는 이 솔루션에 사용된 고수준 아키텍처를 보여줍니다."]

====


== 솔루션 배포

이 솔루션의 배포를 완료하려면 다음 단계를 따르세요.

.1단계: 추가 기능 옵션을 사용하여 Azure Portal을 통해 HCX 설치
[%collapsible%open]
====
설치를 수행하려면 다음 단계를 완료하세요.

. Azure Portal에 로그인하여 Azure VMware Solution 프라이빗 클라우드에 액세스하세요.
. 적절한 프라이빗 클라우드를 선택하고 애드온에 액세스하세요.  *관리 > 추가 기능*으로 이동하면 됩니다.
. HCX 워크로드 모빌리티 섹션에서 *시작하기*를 클릭합니다.
+
image:anfd-hcx-002.png["HCX 워크로드 모빌리티 섹션의 스크린샷입니다."]

. *이용 약관에 동의합니다* 옵션을 선택하고 *활성화 및 배포*를 클릭합니다.
+

NOTE: 기본 배포는 HCX Advanced입니다.  Enterprise Edition을 활성화하려면 지원 요청을 열어주세요.

+

NOTE: 배포에는 약 25~30분이 소요됩니다.

+
image:anfd-hcx-003.png["HCX 워크로드 모빌리티 섹션 완료의 스크린샷입니다."]



====
.2단계: 온프레미스 vCenter Server에 설치 프로그램 OVA 배포
[%collapsible%open]
====
온-프레미스 커넥터가 Azure VMware Solution의 HCX Manager에 연결하려면 온-프레미스 환경에서 적절한 방화벽 포트가 열려 있는지 확인하세요.

온프레미스 vCenter Server에 HCX 커넥터를 다운로드하고 설치하려면 다음 단계를 완료하세요.

. Azure Portal에서 Azure VMware Solution으로 이동하여 프라이빗 클라우드를 선택하고 *관리 > 추가 기능 > HCX를 사용한 마이그레이션*을 선택한 다음 HCX Cloud Manager 포털을 복사하여 OVA 파일을 다운로드합니다.
+

NOTE: HCX 포털에 액세스하려면 기본 CloudAdmin 사용자 자격 증명을 사용하세요.

+
image:anfd-hcx-004.png["HCX OVA 파일을 다운로드하기 위한 Azure Portal의 스크린샷입니다."]

. jumphost를 사용하여 mailto:cloudadmin@vsphere.local[cloudadmin@vsphere.local^]로 HCX 포털에 액세스한 후 *관리 > 시스템 업데이트*로 이동하여 *다운로드 링크 요청*을 클릭합니다.
+

NOTE: OVA 링크를 다운로드하거나 복사하여 브라우저에 붙여넣어 온프레미스 vCenter Server에 배포할 VMware HCX Connector OVA 파일의 다운로드 프로세스를 시작합니다.

+
image:anfd-hcx-005.png["OVA 다운로드 링크의 스크린샷."]

. OVA를 다운로드한 후 *OVF 템플릿 배포* 옵션을 사용하여 온프레미스 VMware vSphere 환경에 배포합니다.
+
image:anfd-hcx-006.png["올바른 OVA 템플릿을 선택하기 위한 스크린샷입니다."]

. OVA 배포에 필요한 모든 정보를 입력하고, *다음*을 클릭한 다음, *마침*을 클릭하여 VMware HCX 커넥터 OVA를 배포합니다.
+

NOTE: 가상 어플라이언스의 전원을 수동으로 켭니다.



단계별 지침은 다음을 참조하세요. https://docs.vmware.com/en/VMware-HCX/services/user-guide/GUID-BFD7E194-CFE5-4259-B74B-991B26A51758.html["VMware HCX 사용자 가이드"^] .

====
.3단계: 라이선스 키로 HCX 커넥터 활성화
[%collapsible%open]
====
온프레미스에 VMware HCX Connector OVA를 배포하고 어플라이언스를 시작한 후 다음 단계를 완료하여 HCX Connector를 활성화합니다.  Azure VMware Solution 포털에서 라이선스 키를 생성하고 VMware HCX Manager에서 활성화합니다.

. Azure Portal에서 Azure VMware Solution으로 이동하여 프라이빗 클라우드를 선택하고 *관리 > 추가 기능 > HCX를 사용한 마이그레이션*을 선택합니다.
. *HCX 키를 사용하여 온프레미스와 연결*에서 *추가*를 클릭하고 활성화 키를 복사합니다.
+
image:anfd-hcx-007.png["HCX 키를 추가하는 스크린샷."]

+

NOTE: 배포된 각 온프레미스 HCX 커넥터에는 별도의 키가 필요합니다.

. 온프레미스 VMware HCX Manager에 로그인하세요. `"https://hcxmanagerIP:9443"` 관리자 자격 증명을 사용합니다.
+

NOTE: OVA 배포 중에 정의된 비밀번호를 사용하세요.

. 라이센스에서 3단계에서 복사한 키를 입력하고 *활성화*를 클릭합니다.
+

NOTE: 온프레미스 HCX 커넥터는 인터넷에 접속할 수 있어야 합니다.

. *데이터 센터 위치*에서 온프레미스에서 VMware HCX Manager를 설치할 수 있는 가장 가까운 위치를 제공합니다.  *계속*을 클릭하세요.
. *시스템 이름*에서 이름을 업데이트하고 *계속*을 클릭합니다.
. *예, 계속*을 클릭합니다.
. *vCenter 연결*에서 vCenter Server의 정규화된 도메인 이름(FQDN) 또는 IP 주소와 해당 자격 증명을 제공하고 *계속*을 클릭합니다.
+

NOTE: 나중에 연결 문제를 방지하려면 FQDN을 사용하세요.

. *SSO/PSC 구성*에서 Platform Services Controller의 FQDN 또는 IP 주소를 입력하고 *계속*을 클릭합니다.
+

NOTE: VMware vCenter Server FQDN 또는 IP 주소를 입력하세요.

. 입력한 정보가 정확한지 확인하고 *다시 시작*을 클릭하세요.
. 서비스가 다시 시작된 후 나타나는 페이지에서 vCenter Server가 녹색으로 표시됩니다.  vCenter Server와 SSO 모두 적절한 구성 매개변수를 가져야 하며, 이는 이전 페이지와 동일해야 합니다.
+

NOTE: 이 프로세스는 약 10~20분 정도 걸리며 플러그인이 vCenter Server에 추가됩니다.

+
image:anfd-hcx-008.png["완료된 프로세스를 보여주는 스크린샷입니다."]



====
.4단계: 온-프레미스 VMware HCX 커넥터를 Azure VMware Solution HCX Cloud Manager와 페어링
[%collapsible%open]
====
온-프레미스와 Azure VMware Solution에 HCX 커넥터를 설치한 후, 페어링을 추가하여 Azure VMware Solution 프라이빗 클라우드에 대한 온-프레미스 VMware HCX 커넥터를 구성합니다.  사이트 페어링을 구성하려면 다음 단계를 완료하세요.

. 온-프레미스 vCenter 환경과 Azure VMware Solution SDDC 간에 사이트 쌍을 만들려면 온-프레미스 vCenter Server에 로그인하고 새 HCX vSphere Web Client 플러그인에 액세스합니다.


image:anfd-hcx-009.png["HCX vSphere Web Client 플러그인의 스크린샷입니다."]

. 인프라에서 *사이트 페어링 추가*를 클릭합니다.



NOTE: Azure VMware Solution HCX Cloud Manager URL 또는 IP 주소와 프라이빗 클라우드에 액세스하기 위한 CloudAdmin 역할의 자격 증명을 입력하세요.

image:anfd-hcx-010.png["CloudAdmin 역할에 대한 스크린샷 URL 또는 IP 주소 및 자격 증명입니다."]

. *연결*을 클릭하세요.



NOTE: VMware HCX Connector는 포트 443을 통해 HCX Cloud Manager IP로 라우팅할 수 있어야 합니다.

. 페어링이 생성되면 새로 구성된 사이트 페어링을 HCX 대시보드에서 사용할 수 있습니다.


image:anfd-hcx-011.png["HCX 대시보드에서 완료된 프로세스의 스크린샷입니다."]

====
.5단계: 네트워크 프로필, 컴퓨팅 프로필 및 서비스 메시 구성
[%collapsible%open]
====
VMware HCX Interconnect 서비스 어플라이언스는 인터넷과 대상 사이트에 대한 개인 연결을 통해 복제 및 vMotion 기반 마이그레이션 기능을 제공합니다.  상호 연결은 암호화, 트래픽 엔지니어링, VM 이동성을 제공합니다.  Interconnect 서비스 어플라이언스를 생성하려면 다음 단계를 완료하세요.

. 인프라에서 *상호 연결 > 다중 사이트 서비스 메시 > 컴퓨팅 프로필 > 컴퓨팅 프로필 만들기*를 선택합니다.



NOTE: 컴퓨팅 프로필은 배포되는 어플라이언스와 HCX 서비스가 액세스할 수 있는 VMware 데이터 센터 부분을 포함한 배포 매개변수를 정의합니다.

image:anfd-hcx-012.png["vSphere 클라이언트 상호 연결 페이지의 스크린샷입니다."]

. 컴퓨팅 프로필을 만든 후 *멀티 사이트 서비스 메시 > 네트워크 프로필 > 네트워크 프로필 만들기*를 선택하여 네트워크 프로필을 만듭니다.


네트워크 프로필은 HCX가 가상 어플라이언스에 사용하는 IP 주소와 네트워크 범위를 정의합니다.


NOTE: 이 단계에는 두 개 이상의 IP 주소가 필요합니다.  이러한 IP 주소는 관리 네트워크에서 Interconnect Appliance에 할당됩니다.

image:anfd-hcx-013.png["vSphere 클라이언트 Interconnect 페이지에 IP 주소를 추가하는 스크린샷입니다."]

. 이제 컴퓨팅 및 네트워크 프로필이 성공적으로 생성되었습니다.
. *상호 연결* 옵션 내에서 *서비스 메시* 탭을 선택하여 서비스 메시를 만들고 온-프레미스 및 Azure SDDC 사이트를 선택합니다.
. 서비스 메시는 로컬 및 원격 컴퓨팅과 네트워크 프로필 쌍을 지정합니다.



NOTE: 이 프로세스의 일환으로 HCX 어플라이언스는 소스 사이트와 대상 사이트 모두에 배포되고 자동으로 구성되어 안전한 전송 패브릭을 생성합니다.

image:anfd-hcx-014.png["vSphere 클라이언트 Interconnect 페이지의 Service Mesh 탭 스크린샷입니다."]

. 이것은 구성의 마지막 단계입니다.  배포를 완료하는 데 약 30분이 소요됩니다.  서비스 메시가 구성되면 워크로드 VM을 마이그레이션하기 위한 IPsec 터널이 성공적으로 생성되어 환경이 준비됩니다.


image:anfd-hcx-015.png["vSphere 클라이언트 Interconnect 페이지에서 완료된 프로세스의 스크린샷입니다."]

====
.6단계: 워크로드 마이그레이션
[%collapsible%open]
====
다양한 VMware HCX 마이그레이션 기술을 사용하여 온-프레미스와 Azure SDDC 간에 워크로드를 양방향으로 마이그레이션할 수 있습니다.  HCX 대량 마이그레이션, HCX vMotion, HCX 콜드 마이그레이션, HCX 복제 지원 vMotion(HCX Enterprise 에디션에서 사용 가능), HCX OS 지원 마이그레이션(HCX Enterprise 에디션에서 사용 가능) 등 다양한 마이그레이션 기술을 사용하여 VMware HCX 활성화 엔터티 간에 VM을 이동할 수 있습니다.

다양한 HCX 마이그레이션 메커니즘에 대해 자세히 알아보려면 다음을 참조하세요. https://learn.microsoft.com/en-us/azure/azure-vmware/architecture-migrate#vmware-hcx-migration-options["VMware HCX 마이그레이션 유형"^] .

*대량 마이그레이션*

이 섹션에서는 대량 마이그레이션 메커니즘에 대해 자세히 설명합니다.  대량 마이그레이션 중에 HCX의 대량 마이그레이션 기능은 vSphere Replication을 사용하여 디스크 파일을 마이그레이션하고 대상 vSphere HCX 인스턴스에서 VM을 다시 생성합니다.

대량 VM 마이그레이션을 시작하려면 다음 단계를 완료하세요.

. *서비스 > 마이그레이션*에서 *마이그레이션* 탭에 액세스합니다.


image:anfd-hcx-016.png["vSphere 클라이언트의 마이그레이션 섹션 스크린샷."]

. *원격 사이트 연결*에서 원격 사이트 연결을 선택하고 소스와 대상을 선택합니다.  이 예에서 대상은 Azure VMware Solution SDDC HCX 엔드포인트입니다.
. *마이그레이션을 위한 VM 선택*을 클릭합니다.  이는 온프레미스 VM의 모든 목록을 제공합니다.  일치:값 표현식을 기준으로 VM을 선택하고 *추가*를 클릭합니다.
. *전송 및 배치* 섹션에서 마이그레이션 프로필을 포함하여 필수 필드(*클러스터*, *저장소*, *대상* 및 *네트워크*)를 업데이트하고 *검증*을 클릭합니다.


image:anfd-hcx-017.png["vSphere 클라이언트의 전송 및 배치 섹션의 스크린샷입니다."]

. 유효성 검사가 완료되면 *이동*을 클릭하여 마이그레이션을 시작합니다.


image:anfd-hcx-018.png["마이그레이션 시작의 스크린샷입니다."]


NOTE: 이 마이그레이션 중에 대상 vCenter 내의 지정된 Azure NetApp Files 데이터 저장소에 플레이스홀더 디스크가 생성되어 소스 VM 디스크의 데이터를 플레이스홀더 디스크로 복제할 수 있습니다.  HBR은 대상에 대한 전체 동기화를 위해 트리거되고, 기준이 완료된 후 RPO(복구 지점 목표) 주기를 기반으로 증분 동기화가 수행됩니다.  전체/증분 동기화가 완료된 후 특정 일정을 설정하지 않으면 자동으로 전환이 실행됩니다.

. 마이그레이션이 완료되면 대상 SDDC vCenter에 액세스하여 해당 내용을 검증합니다.


image:anfd-hcx-019.png["입력/출력 대화 상자 또는 서면 내용을 나타내는 그림"]

HCX를 사용하여 온프레미스에서 Azure VMware 솔루션으로 워크로드를 마이그레이션하는 방법과 다양한 마이그레이션 옵션에 대한 추가 및 자세한 정보는 다음을 참조하세요. https://learn.microsoft.com/en-us/azure/azure-vmware/architecture-migrate["VMware HCX 마이그레이션 고려 사항"^] .

이 과정에 대해 자세히 알아보려면 다음 영상을 시청하세요.

.HCX를 사용한 워크로드 마이그레이션
video::255640f5-4dff-438c-8d50-b01200f017d1[panopto]
HCX vMotion 옵션의 스크린샷은 다음과 같습니다.

image:anfd-hcx-020.png["입력/출력 대화 상자 또는 서면 내용을 나타내는 그림"]

이 과정에 대해 자세히 알아보려면 다음 영상을 시청하세요.

.HCX v모션
video::986bb505-6f3d-4a5a-b016-b01200f03f18[panopto]

NOTE: 마이그레이션을 처리하는 데 충분한 대역폭이 있는지 확인하세요.


NOTE: 대상 ANF 데이터 저장소에는 마이그레이션을 처리할 수 있는 충분한 공간이 있어야 합니다.

====


== 결론

온프레미스의 모든 유형/공급업체 스토리지에 있는 데이터를 대상으로 전체 클라우드 또는 하이브리드 클라우드를 사용하든, Azure NetApp Files 와 HCX는 데이터 요구 사항을 애플리케이션 계층에 원활하게 전달하여 TCO를 줄이는 동시에 애플리케이션 워크로드를 배포하고 마이그레이션할 수 있는 탁월한 옵션을 제공합니다.  어떤 사용 사례든 Azure NetApp Files 와 함께 Azure VMware 솔루션을 선택하면 클라우드의 이점을 빠르게 실현하고, 온프레미스와 여러 클라우드에서 일관된 인프라와 운영을 구현하고, 워크로드를 양방향으로 이식하고, 엔터프라이즈급 용량과 성능을 얻을 수 있습니다.  VMware vSphere Replication, VMware vMotion 또는 NFC(네트워크 파일 복사)를 사용하여 스토리지를 연결하고 VM을 마이그레이션하는 데 사용되는 익숙한 프로세스 및 절차와 동일합니다.



== 테이크아웃

이 문서의 주요 내용은 다음과 같습니다.

* 이제 Azure VMware Solution SDDC에서 Azure NetApp Files 데이터 저장소로 사용할 수 있습니다.
* 온-프레미스에서 Azure NetApp Files 저장소로 데이터를 쉽게 마이그레이션할 수 있습니다.
* 마이그레이션 작업 중에 용량 및 성능 요구 사항을 충족하기 위해 Azure NetApp Files 데이터 저장소를 쉽게 확장하거나 축소할 수 있습니다.




== 추가 정보를 찾을 수 있는 곳

이 문서에 설명된 정보에 대해 자세히 알아보려면 다음 웹사이트 링크를 참조하세요.

* Azure VMware 솔루션 설명서


https://docs.microsoft.com/en-us/azure/azure-vmware/["https://docs.microsoft.com/en-us/azure/azure-vmware/"^]

* Azure NetApp Files 설명서


https://docs.microsoft.com/en-us/azure/azure-netapp-files/["https://docs.microsoft.com/en-us/azure/azure-netapp-files/"^]

* VMware HCX 마이그레이션 고려 사항


https://learn.microsoft.com/en-us/azure/azure-vmware/architecture-migrate["https://learn.microsoft.com/en-us/azure/azure-vmware/architecture-migrate"^]
